<div class="phd-hide-from-print">
	<group-bar [communityName]="communityName" 
		[planName]="planName" 
		[groups]="groups"
		(subgroupSelected)="onSubgroupSelected($event)">
	</group-bar>
</div>

<ng-template #content>
	<main class="d-flex">
		<div ngClass="phd-favorites-summary">
			<summary-header class="phd-hide-from-print" 
				[summaryHeader]="summaryHeader"
				[priceBreakdown]="priceBreakdown" 
				[includeContractedOptions]="includeContractedOptions"
				[isDesignComplete]="isDesignComplete" 
				(isStickyChanged)="onIsStickyChanged($event)"
				(contractedOptionsToggled)="onContractedOptionsToggled()">
			</summary-header>
			<summary-header class="phd-show-on-print phd-print-header" 
				[summaryHeader]="summaryHeader"
				[priceBreakdown]="priceBreakdown" 
				[includeContractedOptions]="includeContractedOptions"
				[isDesignComplete]="isDesignComplete" 
				[isPrintHeader]="true"
				(isStickyChanged)="onIsStickyChanged($event)" 
				(contractedOptionsToggled)="onContractedOptionsToggled()">
			</summary-header>

			<div class="phd-tree-view phd-tree-view-on-print" [class.phd-is-sticky]="isSticky"
				[class.phd-tree-view-presale]="isPresale">
				<ul class="phd-group-list">
					<ng-container *ngFor="let group of groups">
						<span class="phd-show-on-print">&nbsp;</span>
						<div class="phd-group" role="group" attr.aria-label="{{group.label}}" *ngIf="group.subGroups.length > 0">
							<div class="phd-label">
								<h2>{{group.label}}</h2>
								<div *ngIf="!isPresale" class="phd-group-detail">
									<span class="phd-group-subtotal-label">Subtotal : </span>
									<span class="phd-group-subtotal-amount"> {{group.price |
										currency:'USD':'symbol':'0.0-0'}} </span>
								</div>
							</div>
							<ul class="phd-sub-group d-flex flex-column justify-content-between"
								*ngFor="let subGroup of group.subGroups">
								<div role="group" attr.aria-label="{{subGroup.label}}">
									<div class="phd-header d-flex justify-content-between align-items-center">
										<h3>{{subGroup.label}}</h3>
									</div>
									<ng-container *ngFor="let dp of subGroup.points">
										<decision-point-summary *ngIf="displayPoint(dp)"
											[decisionPoint]="dp"
											[subGroup]="subGroup"
											[group]="group"
											[salesChoices]="salesChoices"
											[includeContractedOptions]="includeContractedOptions"
											[buildMode]="buildMode"
											[isDesignComplete]="isDesignComplete"
											[isPresale]="isPresale"
											[favoritesId]="favoritesId" 
											(viewFavorites)="onViewFavorites($event)"
											(removeFavorites)="onRemoveFavorites($event)">
										</decision-point-summary>
									</ng-container>
								</div>
							</ul>
						</div>
					</ng-container>
				</ul>

				<!-- Show Floorplan(s) -->
				<ng-container *ngIf="!noVisibleFP">
					<div class="phd-group ifp-group">
						<div class="phd-floorplan-image-section">
							<div *ngIf="!isPresale" class="phd-choice-expand d-flex flex-row">
								<button class="phd-expendable-circle" (click)="toggleCollapsed()" aria-controls="floorplans">
									<span *ngIf="!showFloorplan" aria-expanded="false" aria-label="Expand Floorplan">
										<i class="fa fa-fw phd-clickable fa-chevron-circle-right" aria-hidden="true"></i>
									</span>
									<span *ngIf="showFloorplan" aria-expanded="true" aria-label="Collapse Floorplan">
										<i class="fa fa-fw phd-clickable fa-chevron-circle-down" aria-hidden="true"></i>
									</span>
								</button>
								<h2 class="phd-label">floorplan image</h2>
							</div>
							<h2 *ngIf="isPresale" class="phd-label">floorplan image</h2>
							<span id="floorplans" *ngIf="showFloorplan || isPresale">
								<ng-container *ngFor="let fpImage of floorPlanImages">
									<div class="phd-sub-group d-flex flex-column justify-content-between">
										<div class="phd-header d-flex justify-content-between align-items-center">
											<span>{{ fpImage.floorName }}</span>
										</div>
										<span *ngIf="fpImage.floorIndex === 0"
											class="phd-floorplan-disclaimer">{{ floorPlanDisclaimer }}</span>
										<div class="d-flex flex-row phd-ifp" id="{{ getIfpId(fpImage) }}"
											[innerHTML]="sanitizer.bypassSecurityTrustHtml(fpImage.svg)"></div>
									</div>
								</ng-container>
								<div class="phd-hide-from-print">
									<!-- hidden instance necessary for floorplan images and interactions with choice removal -->
									<floor-plan
										[height]="'0'"
										[planId$]="marketingPlanId"
										[selectedFloor]="firstDisplayedFloor"
										[subGroup]="IFPsubGroup"
										[isFlipped]="isFloorplanFlipped"
										[ifpID]="'firstDisplayedFloor'"
										(floorPlanSaved)="onFloorPlanSaved($event)"
									></floor-plan>
								</div>
							</span>
						</div>
					</div>
				</ng-container>
			</div>
			<div class="phd-disclaimer phd-hide-from-print">{{ disclaimerText }}</div>
			<div class="phd-footer-bar phd-hide-from-print">
				<footer-bar></footer-bar>
			</div>
		</div>
	</main>
</ng-template>

<div class="phd-hide-from-print">
	<ng-container *ngTemplateOutlet="content"></ng-container>
</div>

<table class="phd-show-on-print">
	<tbody>
		<tr>
			<td>
				<div class="phd-print-content">
					<ng-container *ngTemplateOutlet="content"></ng-container>
				</div>
			</td>
		</tr>
	</tbody>
	<tfoot>
		<tr>
			<td>
				<div class="phd-print-footer-space">&nbsp;</div>
			</td>
		</tr>
	</tfoot>
</table>

<action-bar class="phd-hide-from-print" 
	[primaryAction]="'Back'" 
	[favoritesPrice]="priceBreakdown.favoritesPrice"
	[price]="priceBreakdown.totalPrice" 
	[showPrint]="true" 
	[showFavorites]="false" 
	[isDesignComplete]="isDesignComplete"
	[isPreview]="isPreview" 
	[isPresale]="isPresale" 
	[includeContractedOptions]="includeContractedOptions"
	(callToAction)="onBack()" 
	(toggleContractedOptions)="onContractedOptionsToggled()">
</action-bar>

<div class="phd-print-footer phd-show-on-print">{{ disclaimerText }}</div>